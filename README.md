# Двумерная краевая задача для эллиптического уравнения в полярной системе координат

Данный проект - моя курсовая работа за 5 семестр по следующей теме:

Вариант 65: МКЭ для двумерной краевой задачи для эллиптического уравнения в полярной $(r,\phi)$ системе координат. Базисные функции билинейные на прямоугольниках. Краевые условия всех типов. Коэффициент $\gamma$ разложить по билинейным базисным функциям. Матрицу СЛАУ генерировать в разреженном строчном формате. Для решения СЛАУ использовать МСГ или ЛОС с неполной факторизацией.

Решаемое уравнение в общем виде:
$-div(\lambda grad(u)) + \gamma u = f$

Область интегрирования: $\Omega$

Граница интегрирования: $S = S_1 \lor S_2 \lor S_3$

Краевые условия:
- Первые: $u| _ {s_1} = u_g$
- Вторые: $\lambda \frac{\partial u}{\partial n} = \theta$
- Третьи: $\lambda\frac{\partial u}{\partial n} | _ {s_3} + \beta ( u | _ {s_3} - u_{\beta}) = 0$

$\lambda$ - коэффициент диффузии,

$\beta$ - коэффициент теплообмена.

Согласно условиям варианта, в задаче используется полярная система координат $(r, \phi)$. Для неё формулы операторов уравнения определяются следующим видом:
$$grad\space v = (\frac{\partial v}{\partial r}, \frac{1}{r} \frac{\partial v}{\partial \phi})$$
$$div\space \overrightarrow{Q} = \frac{1}{r} \frac{\partial (rQ_1)}{\partial r} + \frac{1}{r} \frac{\partial Q_2}{\partial \phi}$$
А само уравнение в таком случае будет выглядеть следующим образом:
$$-\frac{1}{r}\frac{\partial}{\partial r}(r\lambda \frac{\partial u}{\partial r}) - \frac{1}{r^2}\frac{\partial}{\partial \phi}(\lambda \frac{\partial u}{\partial \phi}) + \gamma u = f$$

Для вычислений СЛАУ использовался трёхшаговый метод ЛОС с неполным LU-sq предобуславливанием (неполным разложением Холесского) из лабораторной работы №3.

Все подробности курсовой работы смотрите в отчёте, либо в папке "Курсач-в-обсидиане" (для просмотра рекомендую программу *Obsidian* (не реклама)).

# О тестировании

Задача данного варианта нормально без погрешностей **не решается**! Для адекватного решения нужно лучше продумывать, какие тесты брать можно, какие нет. Например, данный курсач не работает на тестах вида $u=r^2 + \varphi^2$. Так же не стоит делать тесты, где значения каких-либо функций будут дробными (кроме тестов на сходимость), либо где лямбда не постоянна. А такие тесты будут получаться почти всегда, например, следующий тест:

> $$-\frac{1}{r}\frac{\partial}{\partial r}(r\lambda \frac{\partial u}{\partial r}) - \frac{1}{r^2}\frac{\partial}{\partial > \phi}(\lambda \frac{\partial u}{\partial \phi}) + \gamma u = f$$
>
> Пусть $u(r,\phi) = r$, тогда
> 
> $$-\frac{1}{r}\frac{\partial}{\partial r}(r\lambda ) + \gamma r = f$$
>
> Пусть $\lambda = r, \gamma = 1$, тогда
> 
> $$-2 + r = f \Rightarrow f = r - 2$$

Здесь дробей нет, но зато $\lambda$ не постоянная. Поскольку в данном варианте $\lambda$ не аппроксимируется, то данный тест не должен считаться без погрешности (в итоге я сделал численное интегрирование, в нём $\lambda$ аппроксимируется адекватно и погрешности нет).

А вот другой тест, похожий, но с $\lambda = \text{const}$:

> $$
> -\frac{1}{r}\frac{\partial}{\partial r}(r\lambda \frac{\partial u}{\partial r}) - \frac{1}{r^2}\frac{\partial}{\partial \phi}(\lambda \frac{\partial u}{\partial \phi}) + \gamma u = f
> $$
> 
> Пусть $u(r, \phi) = r$, тогда
> 
> $$
> -\frac{1}{r}\frac{\partial}{\partial r}(r\lambda ) + \gamma r = f
> $$
>
> Пусть $\lambda = 1, \gamma = 1$, тогда
> 
> $$
> -\frac{1}{r} + r = f \\
> f = r - \frac{1}{r}
> $$

В нём получилась дробь, что тоже даст погрешность. Крч удачи сделать нормальные тесты)))

Как сказал преподаватель, можно сделать специально подобные тесты, показать погрешность и сказать, что типа "Вот, в задаче данного варианта здесь возникают погрешности из-за того-то и того-то".